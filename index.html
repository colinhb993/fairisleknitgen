<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fair Isle Star Band</title>
<style>
  body {
    background: #000000;
    font-family: monospace;
    text-align: center;
    color: #01e49a; /* teal color for text */
  }
  h1 {
    font-size: 2.2rem;
    font-weight: bold;
    margin-bottom: 15px;
  }
  p, li {
    font-size: 1rem;
    line-height: 1.5rem;
    max-width: 700px;
    margin: 10px auto;
    text-align: left;
  }
  ul {
    list-style-type: disc;
    text-align: left;
    margin: 10px auto 20px auto;
    padding-left: 20px;
    max-width: 700px;
  }
  canvas {
    margin: 20px 0;
    border-radius: 8px;
    image-rendering: pixelated; /* crisp edges */
  }
  button {
    margin: 5px;
    padding: 10px 15px;
    border: 1px solid #01e49a;
    border-radius: 8px;
    cursor: pointer;
    background: #000000;
    color: #01e49a;
    font-size: 1rem;
  }
  button:hover {
    background: #01e49a;
    color: #000000;
  }
  a {
    color: #01e49a;
    text-decoration: underline;
  }
</style>
</head>
<body>

<h1>Fair Isle knit pattern generator</h1>

<canvas id="bandPattern" width="675" height="135"></canvas>
<br>
<div>
  <button onclick="giveFeedback('nnn')">ğŸ‘ğŸ‘ğŸ‘</button>
  <button onclick="giveFeedback('nn')">ğŸ‘ğŸ‘</button>
  <button onclick="giveFeedback('n')">ğŸ‘</button>
  <button onclick="startPattern()">â–¶ï¸ Start</button>
  <button onclick="giveFeedback('y')">ğŸ‘</button>
  <button onclick="giveFeedback('yy')">ğŸ‘ğŸ‘</button>
  <button onclick="giveFeedback('yyy')">ğŸ‘ğŸ‘ğŸ‘</button>
</div>

<br>
<p>Fair Isle knitting is a traditional technique where repeating motifs like stars, crosses, and geometric shapes are used to build colorful patterned fabrics. These patterns are symmetrical, bold, and highly recognizable.</p>

<br>
<p>This tool lets you generate Fair Isle knit like patterns focused on star designs.</p>

<br>
<h2>How it works:</h2>
<p>The patterns are created randomly, but your choices guide which directions the generator keeps exploring and which it avoids. Itâ€™s a simple, interactive way to evolve designs, with you as the judge.</p>

<br>
<h2>How to use it:</h2>
<ul>
  <li>Click â–¶ï¸ Start to generate your first pattern.</li>
  <li>Use the buttons to rate what you see:
    <ul>
      <li>ğŸ‘ğŸ‘ğŸ‘ means â€œI really dislike this one.â€</li>
      <li>ğŸ‘ğŸ‘ğŸ‘ means â€œI really love this one.â€</li>
      <li>The middle buttons give softer feedback.</li>
    </ul>
  </li>
  <li>Each time you rate, a new pattern appears.</li>
</ul>

<br>
<p>About my Fair Isle experience: <a href="https://croftandroad.wordpress.com/" target="_blank">https://croftandroad.wordpress.com/</a></p>

<script>
// -----------------------------
// CONFIG
// -----------------------------
const teal = "#01e49a";
const black = "#000000";
const tileSize = 27;
const pixelScale = 5;
const repeats = 5;

// -----------------------------
// RANDOM STAR PARAMETERS
// -----------------------------
function randomStarParams() {
  return {
    numPoints: Math.floor(Math.random() * 5) + 6, // 6-10
    layers: Math.floor(Math.random() * 3) + 3,    // 3-5
    rotation: Math.random() * Math.PI / 10,
    sprinkleChance: Math.random() * 0.15
  };
}

// -----------------------------
// GENERATE STAR GRID
// -----------------------------
function generateStarPattern(size, params) {
  const grid = Array.from({length: size}, () => Array(size).fill(0));
  const center = Math.floor(size / 2);
  const maxRadius = center * 0.9;

  for (let i = 0; i <= center; i++) {
    for (let j = 0; j <= center; j++) {
      const dx = i;
      const dy = j;
      const r = Math.sqrt(dx*dx + dy*dy);
      const angle = Math.atan2(dy, dx) + params.rotation;

      const starVal = (Math.sin(angle * params.numPoints) + 1)/2;
      const ringBand = Math.floor((r / maxRadius) * params.layers);

      let val = 0;
      if (r < maxRadius && starVal > 0.65 && (ringBand % 2 === 0 || (ringBand === 1 && Math.random() < 0.7))) val = 1;
      if (r < maxRadius*0.85 && Math.random() < params.sprinkleChance) val = 1;
      if (starVal > 0.85 && Math.random() < 0.25) val = 1;

      grid[center + i][center + j] = val;
      grid[center + i][center - j] = val;
      grid[center - i][center + j] = val;
      grid[center - i][center - j] = val;
    }
  }
  return grid;
}

// -----------------------------
// DRAW BAND
// -----------------------------
function drawBand(grid, canvasId, repeats) {
  const canvas = document.getElementById(canvasId);
  const ctx = canvas.getContext("2d");
  const size = grid.length;

  canvas.width = size * pixelScale * repeats;
  canvas.height = size * pixelScale;

  ctx.fillStyle = black;
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  for (let r = 0; r < repeats; r++) {
    for (let y = 0; y < size; y++) {
      for (let x = 0; x < size; x++) {
        if (grid[y][x] === 1) {
          ctx.fillStyle = teal;
          ctx.fillRect(r*size*pixelScale + x*pixelScale, y*pixelScale, pixelScale, pixelScale);
        }
      }
    }
  }
}

// -----------------------------
// MAIN LOOP
// -----------------------------
let currentParams = null;

function startPattern() {
  currentParams = randomStarParams();
  const grid = generateStarPattern(tileSize, currentParams);
  drawBand(grid, "bandPattern", repeats);
}

function giveFeedback(resp) {
  if (!currentParams) {
    console.log("No pattern yet â€” press Start first.");
    return;
  }
  console.log("Feedback:", resp, "for params:", currentParams);
  currentParams = randomStarParams();
  const grid = generateStarPattern(tileSize, currentParams);
  drawBand(grid, "bandPattern", repeats);
}
</script>

</body>
</html>
